# Story 1.3: åŸºç¡€è¯­éŸ³è¯†åˆ« (é˜¿é‡Œäº‘ASR APIé›†æˆ)

Status: Ready

## Story

As a ç²¤è¯­ç”¨æˆ·,
I want æœºå™¨äººèƒ½å¤Ÿé€šè¿‡é˜¿é‡Œäº‘ASR APIè¯†åˆ«æˆ‘çš„ç²¤è¯­è¯­éŸ³æŒ‡ä»¤,
so that æˆ‘å¯ä»¥è·å¾—å‡†ç¡®çš„è¯­éŸ³è¯†åˆ«ç»“æœå¹¶æ‰§è¡Œç›¸åº”çš„æ“ä½œã€‚

## å¯éªŒè¯æ€§è®¾è®¡åŸåˆ™

**ğŸš¨ å…³é”®è¦æ±‚**: æœ¬Storyå®Œæˆåå¿…é¡»100%å¯éªŒè¯ï¼Œé¿å…Story 1.2çš„éªŒè¯é—®é¢˜

### éªŒè¯ç­–ç•¥
1. **çœŸå®APIéªŒè¯**: ä½¿ç”¨çœŸå®çš„é˜¿é‡Œäº‘ASR APIè¿›è¡Œæµ‹è¯•
2. **ç«¯åˆ°ç«¯æµ‹è¯•**: ä»éŸ³é¢‘è¾“å…¥åˆ°è¯†åˆ«ç»“æœè¾“å‡ºçš„å®Œæ•´æµç¨‹éªŒè¯
3. **å¯æµ‹è¯•æ¶æ„**: æ¯ä¸ªç»„ä»¶éƒ½æœ‰ç‹¬ç«‹çš„æµ‹è¯•æ¥å£
4. **æ˜ç¡®éªŒæ”¶æ ‡å‡†**: æ‰€æœ‰ACéƒ½æ˜¯å¯é‡åŒ–å’Œå¯æµ‹è¯•çš„

## Acceptance Criteria

1. **é˜¿é‡Œäº‘ASR APIé›†æˆ** (AC-001)
   - âœ… æˆåŠŸé›†æˆé˜¿é‡Œäº‘ASR API (ç²¤è¯­paraformer-v1æ¨¡å‹)
   - âœ… APIå¯†é’¥é…ç½®æ­£ç¡®ï¼Œèƒ½å¤Ÿé€šè¿‡è®¤è¯
   - âœ… æ”¯æŒHTTPSè¯·æ±‚å’Œå“åº”å¤„ç†
   - âœ… é”™è¯¯å¤„ç†æœºåˆ¶å®Œæ•´ï¼ˆç½‘ç»œé”™è¯¯ã€APIé”™è¯¯ç­‰ï¼‰

2. **éŸ³é¢‘æ ¼å¼å¤„ç†** (AC-002)
   - âœ… æ”¯æŒPCMæ ¼å¼éŸ³é¢‘è¾“å…¥ï¼ˆ16kHz, 16-bit, monoï¼‰
   - âœ… PCMè½¬WAVæ ¼å¼è½¬æ¢æ­£ç¡®
   - âœ… WAVè½¬Base64ç¼–ç æ­£ç¡®
   - âœ… éŸ³é¢‘æ•°æ®æ ¼å¼ç¬¦åˆé˜¿é‡Œäº‘APIè¦æ±‚

3. **ç²¤è¯­è¯­éŸ³è¯†åˆ«** (AC-003)
   - âœ… ç²¤è¯­è¯­éŸ³è¯†åˆ«å‡†ç¡®ç‡ > 85% (æ ‡å‡†æµ‹è¯•ç¯å¢ƒ)
   - âœ… æ”¯æŒç²¤è¯­å¸¸ç”¨è¯æ±‡å’ŒçŸ­è¯­è¯†åˆ«
   - âœ… è¯†åˆ«ç»“æœä»¥UTF-8ç¼–ç æ­£ç¡®è¿”å›
   - âœ… æ”¯æŒæœ€é•¿10ç§’çš„è¯­éŸ³è¾“å…¥

4. **è¯†åˆ«ç»“æœå¤„ç†** (AC-004)
   - âœ… JSONæ ¼å¼è¯†åˆ«ç»“æœè§£ææ­£ç¡®
   - âœ… è¯†åˆ«ç½®ä¿¡åº¦æå–å’ŒéªŒè¯
   - âœ… ç©ºç»“æœå’Œé”™è¯¯ç»“æœå¤„ç†
   - âœ… ç»“æœé€šè¿‡ROS2è¯é¢˜æ­£ç¡®å‘å¸ƒ

5. **ç³»ç»Ÿæ€§èƒ½è¦æ±‚** (AC-005)
   - âœ… ç«¯åˆ°ç«¯å“åº”æ—¶é—´ < 3ç§’ï¼ˆä»å½•éŸ³å¼€å§‹åˆ°ç»“æœè¾“å‡ºï¼‰
   - âœ… APIè°ƒç”¨æˆåŠŸç‡ > 95%
   - âœ… ç³»ç»Ÿå†…å­˜ä½¿ç”¨ < 100MB
   - âœ… CPUä½¿ç”¨ç‡ < 50%ï¼ˆå•æ ¸ï¼‰

6. **é”™è¯¯å¤„ç†å’Œæ¢å¤** (AC-006)
   - âœ… ç½‘ç»œè¿æ¥å¤±è´¥è‡ªåŠ¨é‡è¯•ï¼ˆæœ€å¤š3æ¬¡ï¼‰
   - âœ… APIé™æµå’Œé”™è¯¯ç å¤„ç†
   - âœ… éŸ³é¢‘å½•åˆ¶å¤±è´¥æ£€æµ‹å’ŒæŠ¥å‘Š
   - âœ… ç³»ç»Ÿå¼‚å¸¸æ¢å¤æœºåˆ¶

## Tasks / Subtasks

### ä»»åŠ¡1: é˜¿é‡Œäº‘ASR APIé›†æˆå¼€å‘ (AC-001, AC-006) - MVPæ ¸å¿ƒ
- [ ] 1.1 åˆ›å»ºé˜¿é‡Œäº‘ASRæœåŠ¡å®¢æˆ·ç«¯ç±» (150è¡Œ)
  - [ ] 1.1.1 å®ç°APIè®¤è¯æœºåˆ¶
  - [ ] 1.1.2 å®ç°HTTPSè¯·æ±‚å°è£…
  - [ ] 1.1.3 å®ç°åŸºç¡€é”™è¯¯å¤„ç†
  - [ ] 1.1.4 æ·»åŠ APIå“åº”è§£æ

- [ ] 1.2 é…ç½®ç®¡ç†ç³»ç»Ÿ (50è¡Œ)
  - [ ] 1.2.1 APIå¯†é’¥é…ç½®
  - [ ] 1.2.2 åŸºç¡€ç¯å¢ƒå˜é‡æ”¯æŒ

### ä»»åŠ¡2: éŸ³é¢‘å¤„ç†ç®¡é“ (AC-002) - MVPæ ¸å¿ƒ
- [ ] 2.1 éŸ³é¢‘æ ¼å¼è½¬æ¢å™¨ (100è¡Œ)
  - [ ] 2.1.1 PCMåˆ°WAVè½¬æ¢
  - [ ] 2.1.2 WAVåˆ°Base64ç¼–ç 
  - [ ] 2.1.3 åŸºç¡€éŸ³é¢‘éªŒè¯

### ä»»åŠ¡3: ç²¤è¯­ASRè¯†åˆ«å¼•æ“ (AC-003, AC-004) - MVPæ ¸å¿ƒ
- [ ] 3.1 ASRè¯†åˆ«æ ¸å¿ƒæœåŠ¡ (100è¡Œ)
  - [ ] 3.1.1 éŸ³é¢‘æ•°æ®é¢„å¤„ç†
  - [ ] 3.1.2 é˜¿é‡Œäº‘APIè°ƒç”¨
  - [ ] 3.1.3 è¯†åˆ«ç»“æœè§£æ

- [ ] 3.2 ç»“æœå¤„ç†å’Œå‘å¸ƒ (80è¡Œ)
  - [ ] 3.2.1 JSONç»“æœè§£æ
  - [ ] 3.2.2 åŸºç¡€ç½®ä¿¡åº¦è¿‡æ»¤
  - [ ] 3.2.3 ROS2è¯é¢˜å‘å¸ƒ

### ä»»åŠ¡4: ROS2èŠ‚ç‚¹é›†æˆ (AC-004, AC-005) - MVPæ ¸å¿ƒ
- [ ] 4.1 ROS2æœåŠ¡èŠ‚ç‚¹ (80è¡Œ)
  - [ ] 4.1.1 éŸ³é¢‘è¾“å…¥è¯é¢˜è®¢é˜…
  - [ ] 4.1.2 ASRæœåŠ¡è°ƒç”¨
  - [ ] 4.1.3 è¯†åˆ«ç»“æœè¯é¢˜å‘å¸ƒ
  - [ ] 4.1.4 åŸºç¡€æ€§èƒ½ç›‘æ§

### ä»»åŠ¡5: MVPæµ‹è¯•å¥—ä»¶ (æ‰€æœ‰ACéªŒè¯) - å¯éªŒè¯æ€§ä¿è¯
- [ ] 5.1 å•å…ƒæµ‹è¯• (110è¡Œ)
  - [ ] 5.1.1 APIå®¢æˆ·ç«¯æµ‹è¯• (60è¡Œ)
  - [ ] 5.1.2 éŸ³é¢‘å¤„ç†æµ‹è¯• (50è¡Œ)

- [ ] 5.2 é›†æˆæµ‹è¯• (130è¡Œ)
  - [ ] 5.2.1 ç«¯åˆ°ç«¯è¯­éŸ³è¯†åˆ«æµ‹è¯• (80è¡Œ)
  - [ ] 5.2.2 çœŸå®APIéªŒè¯æµ‹è¯• (50è¡Œ)

- [ ] 5.3 éªŒæ”¶æµ‹è¯• (æ ¸å¿ƒç”¨æˆ·åœºæ™¯) (50è¡Œ)
  - [ ] 5.3.1 åŸºç¡€ç²¤è¯­æŒ‡ä»¤è¯†åˆ«æµ‹è¯• ("æ‰“å¼€ç¯å…‰")
  - [ ] 5.3.2 ç®€å•å¯¹è¯è¯†åˆ«æµ‹è¯• ("ä»Šå¤©å¤©æ°”å¦‚ä½•")
  - [ ] 5.3.3 æ•°å­—è¯†åˆ«æµ‹è¯• ("è®¾ç½®é—¹é’Ÿåˆ°8ç‚¹")
  - [ ] 5.3.4 åŸºç¡€æ€§èƒ½éªŒè¯æµ‹è¯•

## Dev Notes

### æŠ€æœ¯çº¦æŸå’Œæ¶æ„è¦æ±‚ (MVPä¼˜å…ˆ)
- **çº¯åœ¨çº¿æ¶æ„**: ä¸¥æ ¼ç¦æ­¢æœ¬åœ°ASRå¤„ç†ï¼Œ100%ä¾èµ–é˜¿é‡Œäº‘API
- **ROS2é›†æˆ**: æ‰€æœ‰åŠŸèƒ½é€šè¿‡ROS2èŠ‚ç‚¹å°è£…ï¼Œä½¿ç”¨æ ‡å‡†è¯é¢˜/æœåŠ¡æ¥å£
- **Python 3.10**: ä½¿ç”¨ç³»ç»ŸPython 3.10ï¼Œç¡®ä¿å…¼å®¹æ€§
- **MVPç®€æ´æ€§**: æ ¸å¿ƒä»£ç é‡æ§åˆ¶åœ¨~380è¡Œï¼Œä¸“æ³¨åŸºç¡€åŠŸèƒ½å®ç°

### å…³é”®è®¾è®¡å†³ç­– (MVPä¼˜å…ˆ)
1. **APIä¼˜å…ˆ**: ç›´æ¥ä½¿ç”¨é˜¿é‡Œäº‘ASR APIï¼Œä¸ä½¿ç”¨æœ¬åœ°æ¨¡å‹
2. **ç®€å•å¯é **: é¿å…å¤æ‚çš„éŸ³é¢‘å¤„ç†ï¼Œä¸“æ³¨æ ¸å¿ƒåŠŸèƒ½
3. **å¿«é€ŸéªŒè¯**: ä¼˜å…ˆå®ç°åŸºæœ¬åŠŸèƒ½ï¼Œç¡®ä¿å¯æµ‹è¯•æ€§
4. **MVPèŒƒå›´**: ä¸“æ³¨åŸºç¡€ASRåŠŸèƒ½ï¼Œé¿å…è¿‡åº¦å·¥ç¨‹åŒ–

### é¡¹ç›®ç»“æ„å¯¹é½ (MVPä¼˜å…ˆ)
```
src/
â”œâ”€â”€ xlerobot/
â”‚   â”œâ”€â”€ asr/
â”‚   â”‚   â”œâ”€â”€ __init__.py
â”‚   â”‚   â”œâ”€â”€ aliyun_asr_client.py      # é˜¿é‡Œäº‘ASRå®¢æˆ·ç«¯ (~150è¡Œ)
â”‚   â”‚   â”œâ”€â”€ audio_processor.py        # éŸ³é¢‘å¤„ç† (~100è¡Œ)
â”‚   â”‚   â””â”€â”€ recognition_service.py    # è¯†åˆ«æœåŠ¡ (~100è¡Œ)
â”‚   â”œâ”€â”€ common/
â”‚   â”‚   â””â”€â”€ config_manager.py         # é…ç½®ç®¡ç† (~50è¡Œ)
â”‚   â””â”€â”€ nodes/
â”‚       â””â”€â”€ asr_service_node.py       # ROS2æœåŠ¡èŠ‚ç‚¹ (~80è¡Œ)
tests/
â”œâ”€â”€ unit/
â”‚   â”œâ”€â”€ test_aliyun_asr_client.py     # APIå®¢æˆ·ç«¯æµ‹è¯• (~60è¡Œ)
â”‚   â””â”€â”€ test_audio_processor.py       # éŸ³é¢‘å¤„ç†æµ‹è¯• (~50è¡Œ)
â”œâ”€â”€ integration/
â”‚   â””â”€â”€ test_end_to_end_asr.py        # ç«¯åˆ°ç«¯æµ‹è¯• (~80è¡Œ)
â””â”€â”€ validation/
    â””â”€â”€ real_api_validation.py        # çœŸå®APIéªŒè¯ (~50è¡Œ)
```

### æµ‹è¯•ç­–ç•¥
- **çœŸå®APIæµ‹è¯•**: ä½¿ç”¨é˜¿é‡Œäº‘ASR APIçš„çœŸå®ç¯å¢ƒè¿›è¡Œæµ‹è¯•
- **ç²¤è¯­æµ‹è¯•é›†**: å‡†å¤‡æ ‡å‡†çš„ç²¤è¯­æµ‹è¯•éŸ³é¢‘æ–‡ä»¶
- **è‡ªåŠ¨åŒ–æµ‹è¯•**: æ‰€æœ‰æµ‹è¯•éƒ½å¯ä»¥é€šè¿‡å‘½ä»¤è¡Œè‡ªåŠ¨æ‰§è¡Œ
- **æŒç»­é›†æˆ**: æµ‹è¯•é›†æˆåˆ°CI/CDç®¡é“ä¸­

### æ€§èƒ½åŸºå‡† (MVPç›®æ ‡)
- **éŸ³é¢‘å½•åˆ¶**: <1ç§’
- **æ ¼å¼è½¬æ¢**: <0.5ç§’
- **APIè°ƒç”¨**: <2ç§’ï¼ˆåŒ…æ‹¬ç½‘ç»œå»¶è¿Ÿï¼‰
- **ç»“æœå¤„ç†**: <0.5ç§’
- **æ€»å“åº”æ—¶é—´**: <3ç§’

### MVPèŒƒå›´è¾¹ç•Œ
**åŒ…å«**:
- åŸºç¡€ç²¤è¯­è¯­éŸ³è¯†åˆ«åŠŸèƒ½
- é˜¿é‡Œäº‘ASR APIé›†æˆ
- ROS2èŠ‚ç‚¹å°è£…
- æ ¸å¿ƒé”™è¯¯å¤„ç†
- åŸºç¡€æ€§èƒ½ç›‘æ§

**ä¸åŒ…å«** (åç»­è¿­ä»£):
- å¤æ‚çš„éŸ³é¢‘é¢„å¤„ç†
- é«˜çº§æ€§èƒ½ä¼˜åŒ–
- å¤šè¯­è¨€æ”¯æŒ
- é«˜çº§é”™è¯¯æ¢å¤æœºåˆ¶
- ç›‘æ§ä»ªè¡¨æ¿

### References
- [Source: docs/prd-simple-online-services.md#æŠ€æœ¯æ¶æ„]
- [Source: docs/architecture-design-simple-online-services.md#ç³»ç»Ÿæ¶æ„è®¾è®¡]
- [Source: docs/three-iterations-wbs.md#è¿­ä»£1-Epicåˆ†è§£]
- [Source: docs/aliyun-api-integration-guide.md#ASR APIé›†æˆ]

## Dev Agent Record

### Context Reference
<!-- Story context XML generated by story-context workflow -->
- [Source: docs/stories/story-context-1.3.xml] - Complete technical context for Developer Agent including artifacts, constraints, interfaces, and testing standards

### Agent Model Used
Claude Sonnet 4.5 (claude-sonnet-4-5-20250929)

### Debug Log References

### Completion Notes List

### File List

#### Phase 1 - é˜¿é‡Œäº‘ASR APIé›†æˆ (3ä¸ªæ–‡ä»¶) - MVPæ ¸å¿ƒ
- `src/xlerobot/asr/aliyun_asr_client.py` - é˜¿é‡Œäº‘ASRå®¢æˆ·ç«¯ (~150è¡Œ)
- `src/xlerobot/asr/audio_processor.py` - éŸ³é¢‘å¤„ç†ç®¡é“ (~100è¡Œ)
- `src/xlerobot/asr/recognition_service.py` - è¯†åˆ«æœåŠ¡æ ¸å¿ƒ (~100è¡Œ)

#### Phase 2 - é…ç½®å’ŒèŠ‚ç‚¹é›†æˆ (2ä¸ªæ–‡ä»¶) - MVPæ ¸å¿ƒ
- `src/xlerobot/common/config_manager.py` - é…ç½®ç®¡ç† (~50è¡Œ)
- `src/xlerobot/nodes/asr_service_node.py` - ROS2æœåŠ¡èŠ‚ç‚¹ (~80è¡Œ)

#### Phase 3 - MVPæµ‹è¯•å¥—ä»¶ (4ä¸ªæ–‡ä»¶) - å¯éªŒè¯æ€§ä¿è¯
- `tests/unit/test_aliyun_asr_client.py` - APIå®¢æˆ·ç«¯æµ‹è¯• (~60è¡Œ)
- `tests/unit/test_audio_processor.py` - éŸ³é¢‘å¤„ç†æµ‹è¯• (~50è¡Œ)
- `tests/integration/test_end_to_end_asr.py` - ç«¯åˆ°ç«¯æµ‹è¯• (~80è¡Œ)
- `tests/validation/real_api_validation.py` - çœŸå®APIéªŒè¯æµ‹è¯• (~50è¡Œ)

**æ€»ä»£ç é‡**: ~620è¡Œ (åŒ…æ‹¬æµ‹è¯•å¥—ä»¶)
**æ ¸å¿ƒä¸šåŠ¡ä»£ç **: ~380è¡Œ
**æµ‹è¯•ä»£ç **: ~240è¡Œ

## æ›´æ–°è®°å½•

| ç‰ˆæœ¬ | æ—¥æœŸ | æ›´æ–°å†…å®¹ | ä½œè€… | éªŒè¯çŠ¶æ€ |
|------|------|----------|------|----------|
| 1.0 | 2025-11-09 | åˆ›å»ºStory 1.3ï¼Œè®¾è®¡å®Œå…¨å¯éªŒè¯æ¶æ„ | Bob (Scrum Master) | âœ… å¯éªŒè¯è®¾è®¡å®Œæˆ |
| 1.1 | 2025-11-09 | MVPä¼˜åŒ–ï¼šç»Ÿä¸€é¡¹ç›®ç»“æ„ï¼Œä¿®æ­£ä»£ç é‡ï¼Œæ˜ç¡®ç”¨æˆ·åœºæ™¯ | Bob (Scrum Master) | âœ… MVPè®¾è®¡å®Œæˆ |